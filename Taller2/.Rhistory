length(name(datos)
length(name(datos)
length(name(datos)
length(names(datos)
length(names(datos)
length(names(datos))
t(y)*(diag(length(names(datos)))-1)
(diag(length(names(datos)))-1)
(diag(length(names(datos)))-1
(diag(length(names(datos)-1))
(diag((length(names(datos))-1))
n <- length(names(datos))-1
n
n <- length(names(datos))-1# 5variables indp y 1 indep
t(y)*(diag(length(names(datos)))-1)
rep(1,10)
rep(1,n*n)
t(y)*(diag(n)-(1/n)%*% matrix(rep(1,n*n) nrow = n, ncol = n)
t(y)*(diag(n)-(1/n)%*% matrix(rep(1,n*n),nrow = n, ncol = n))
(1/n)%*% matrix(rep(1,n*n),nrow = n, ncol = n))
(1/n)
matrix(rep(1,n*n),nrow = n, ncol = n))
n
n
n*n
rep(1,n*n)
(1/n)%*% matrix(rep(1,n*n),nrow = n, ncol = n))
matrix(c(rep(1,n*n)),nrow = n, ncol = n))
n <- length(names(datos))-1# 5variables indp y 1 indep
matrix(c(rep(1,n*n)),nrow = n, ncol = n))
c(rep(1,n*n))
a <- c(rep(1,n*n))
matrix(a,nrow = n, ncol = n)
t(y)*(diag(n)-(1/n)%*%matrix(c(rep(1,n*n)),nrow = n, ncol = n)
t(y)*(diag(n)-(1/n)%*% matrix(c(rep(1,n*n)),nrow = n, ncol = n)
t(y)*(diag(n)-(1/n)%*% matrix(c(rep(1,n*n)),nrow = n, ncol = n))
(1/n)%*% matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)*diag(n)
t(y)
str(datos)
library(tidyverse)
datos <- read_csv("seguro.csv")
datos <- datos %>% select(-region) %>%
rename(edad = 1,sexo = 2,imc = 3,nhijos = 4,fuma = 5,gastos = 6)%>%
mutate(sexo = recode(sexo, male = "masculino", female = "femenino"),
fuma = recode(fuma, yes = "si", no = "no"))
datos
#################################################################################################
names(datos)
attach(datos)
X <- model.matrix(gastos~edad+sexo+imc+nhijos+fuma,data=datos)
C <- solve(t(X)%*%X);C
dim(C) #matriz de dimencion k*k ... k:número de coeficientes de c
t
y <- data.matrix(gastos)
dim(y)
dim(t(X))
t(X)%*%y
solve(t(X)%*%X)%*%(t(X)%*%y)
library(broom)
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
n <- length(names(datos))-1# 5variables indp y 1 indep
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
t(y)*diag(n)
diag(n)
t(y)%*%diag(n)-(1/n)%*%matrix(c(rep(1,n*n)),nrow = n, ncol = n)
t(y)%*%diag(n)
dim(t(y))
dim(diag(n))
dim(t(y))
dim(diag(n))
t(y)%*%(diag(n)-(1/n)%*%matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)%*%(diag(n)-(1/n)%*%matrix(c(rep(1,n*n)),nrow = n, ncol = n)))
(1/n)%*%matrix(c(rep(1,n*n)),nrow = n, ncol = n)
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
t(y)%*%(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)%*%(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n) %>% dim()
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n) %>% dim()
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n) )
dim(t(y))
n <- length(gastos)
n <- length(gastos);n
p <- length(names(datos))-1;p# 5variables indp y 1 indep
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)%*%((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
library(broom)
modelo |> aov() |> summary()
t(y)%*%((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)%*%((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
str(datos)
library(tidyverse)
datos <- read_csv("seguro.csv")
datos <- datos %>% select(-region) %>%
rename(edad = 1,sexo = 2,imc = 3,nhijos = 4,fuma = 5,gastos = 6)%>%
mutate(sexo = recode(sexo, male = "masculino", female = "femenino"),
fuma = recode(fuma, yes = "si", no = "no"))
datos
#################################################################################################
names(datos)
attach(datos)
X <- model.matrix(gastos~edad+sexo+imc+nhijos+fuma,data=datos)
C <- solve(t(X)%*%X);C
dim(C) #matriz de dimencion k*k ... k:número de coeficientes de c
t
y <- data.matrix(gastos)
dim(y)
dim(t(X))
t(X)%*%y
solve(t(X)%*%X)%*%(t(X)%*%y)
library(broom)
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
n <- length(gastos);n
p <- length(names(datos))-1;p# 5variables indp y 1 indep
(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n)
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
t(y)%*%((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
library(broom)
modelo |> aov() |> summary()
library(broom)
anva <- modelo |> aov() |> summary()
anva <- modelo |> aov() |> summary();anva
sum(anva[,2])
anva[,2]
anva <- modelo |> aov() |> summary()|> tidy();anva
anva
anva <- modelo |> aov() |> summary()|> tidy();anva
library(broom)
anva <- modelo |> aov() |> summary()|> tidy();anva
library(broom)
anva <- modelo |> tidy() |> aov() |> summary();anva
modelo |> aov() |> summary()|> tidy()
anva <- modelo |> aov() |> summary()
anva
as.data.frame(anva)
3302+1+405+29+364+6436
t(y)%*%(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
data.frame(anva)
SCT <- t(y)%*%(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
SCT
anva <- modelo |> aov()
anva
anva <- modelo |> aov() |> summary()
library(broom)
modelo |> aov() |> summary()
anva <- modelo |> aov()
anva <- modelo |> aov()
anva <- modelo |> aov();anva
sum(anva[,1])
anva[,1]
[1,]
anva[1,]
anva <- modelo |> aov();anva
anva <- modelo |> anova();anva
SCT<-sum(sc[,2])
SCT<-sum(anva[,2])
SCT
SCT<-sum(anva[,2]);SCT
library(broom)
modelo |> aov() |> summary()
anva <- modelo |> anova();anva
SCT<-sum(anva[,2]);SCT
#H_n : matriz hat  identidad de n*n
X%*%solve(t(X)%*%X)%*%(t(X)
#H_n : matriz hat  identidad de n*n
X %*% solve(t(X)%*%X)%*%(t(X))
#H_n : matriz hat  identidad de n*n
X%*% solve(t(X)%*%X)%*%(t(X))
#H_n : matriz hat  identidad de n*n
H <- X%*% solve(t(X)%*%X)%*%(t(X))
dim(H)
SCREGRE <- t(y)%*%(H-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
SCREGRE <- t(y)%*%(H-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCREGRE
I_n <- diag(n)
SCT <- t(y)%*%(I_n-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
I_n <- diag(n)
SCT <- t(y)%*%(I_n-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCT
SCT<-sum(anva[,2]);SCT
#H_n : matriz hat  identidad de n*n
H <- X%*% solve(t(X)%*%X)%*%(t(X))
dim(H)
SCREGRE <- t(y)%*%(H-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCREGRE
SCREGRE <- t(y)%*%(H-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCREGRE
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n<- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n<- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n))
matrix(c(rep(1,n*n)),nrow = n, ncol = n))
matrix(c(rep(1,n*n)),nrow = n, ncol = n))
(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
matrix(c(rep(1,n*n)),nrow = n, ncol = n))
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
(diag(n)-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y
dim((1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
(diag(n)-(1/n)*J_n)%*%y
dim((1/n)*J_n)
SCREGRE <- t(y)%*%(H-(1/n)*J_n)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCREGRE
I_n
H
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[1,p+1]
p
anva[p+1,1]
anva[p+1,2]
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[p+1,2]
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[p+1,2]
summary(modelo)
summary(modelo)$sigma
summary(modelo)$sigma**2
summary(modelo)$sigma**2*solve(t(X)%*%X)
vcov(modelo)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(1,4),
col        = "forestgreen")
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(1,4),
col        = "forestgreen")
names(datos)
library(car)
names(datos)
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(3,4),
col        = "forestgreen")
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(4,5),
col        = "forestgreen")
modelo
modelo <- lm(gastos~ ., data = datos)
modelo <- lm(gastos~ ., data = datos)
modelo %>% confint
modelo %>% confint
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
modelo %>% confint
library(tidyverse)
datos <- read_csv("seguro.csv")
datos <- datos %>% select(-region) %>%
rename(edad = 1,sexo = 2,imc = 3,nhijos = 4,fuma = 5,gastos = 6)%>%
mutate(sexo = recode(sexo, male = "masculino", female = "femenino"),
fuma = recode(fuma, yes = "si", no = "no"))
datos
#################################################################################################
names(datos)
attach(datos)
X <- model.matrix(gastos~edad+sexo+imc+nhijos+fuma,data=datos)
C <- solve(t(X)%*%X);C
dim(C) #matriz de dimencion k*k ... k:número de coeficientes de c
t
y <- data.matrix(gastos)
dim(y)
dim(t(X))
t(X)%*%y
solve(t(X)%*%X)%*%(t(X)%*%y)
library(broom)
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
library(broom)
modelo |> aov() |> summary()
anva <- modelo |> anova();anva
#I_n : matriz identidad de n*n
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
#J_n : matriz de puro 1s ,dim nxn
(diag(n)-(1/n)*J_n)%*%y
dim((1/n)*J_n)
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
I_n <- diag(n)
SCT <- t(y)%*%(I_n-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCT
SCT<-sum(anva[,2]);SCT
#H_n : matriz hat  identidad de n*n
H <- X%*% solve(t(X)%*%X)%*%(t(X))
dim(H)
SCREGRE <- t(y)%*%(H-(1/n)*J_n)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[p+1,2]
#El valor de σ2 es estimado mediante el Cuadrado Medio del Error (sacado del anva)
summary(modelo)$sigma**2
summary(modelo)$sigma**2*solve(t(X)%*%X)
vcov(modelo)
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(4,5),
col        = "forestgreen")
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
modelo %>% confint
modelo <- lm(gastos~ ., data = datos)
modelo %>% confint
modelo <- lm(gastos~ ., data = datos)
modelo %>% confint(level = 0.95)
modelo %>% summary()
anva
anva <- modelo |> anova();anva
anva
anva <- modelo |> anova();anva
k
k <- length(names(datos))
k <- length(names(datos));k
k <- length(names(datos));k #numero de coeficientes de regresion betas coicide con el numero de varibales indp y dep
SCT
SCREGRE
SCRERROR
library(tidyverse)
datos <- read_csv("seguro.csv")
datos <- datos %>% select(-region) %>%
rename(edad = 1,sexo = 2,imc = 3,nhijos = 4,fuma = 5,gastos = 6)%>%
mutate(sexo = recode(sexo, male = "masculino", female = "femenino"),
fuma = recode(fuma, yes = "si", no = "no"))
datos
#################################################################################################
names(datos)
attach(datos)
X <- model.matrix(gastos~edad+sexo+imc+nhijos+fuma,data=datos)
C <- solve(t(X)%*%X);C
dim(C) #matriz de dimencion k*k ... k:número de coeficientes de c
t
y <- data.matrix(gastos)
dim(y)
dim(t(X))
t(X)%*%y
solve(t(X)%*%X)%*%(t(X)%*%y)
library(broom)
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
library(broom)
modelo |> aov() |> summary()
anva <- modelo |> anova();anva
#I_n : matriz identidad de n*n
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
#J_n : matriz de puro 1s ,dim nxn
(diag(n)-(1/n)*J_n)%*%y
dim((1/n)*J_n)
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
I_n <- diag(n)
SCT <- t(y)%*%(I_n-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCT
SCT<-sum(anva[,2]);SCT
#H_n : matriz hat  identidad de n*n
H <- X%*% solve(t(X)%*%X)%*%(t(X))
dim(H)
SCREGRE <- t(y)%*%(H-(1/n)*J_n)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[p+1,2]
#El valor de σ2 es estimado mediante el Cuadrado Medio del Error (sacado del anva)
summary(modelo)$sigma**2
summary(modelo)$sigma**2*solve(t(X)%*%X)
vcov(modelo)
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(4,5),
col        = "forestgreen")
modelo <- lm(gastos~ ., data = datos)
modelo %>% summary()
anva <- modelo |> anova();anva
k <- length(names(datos));k #numero de coeficientes de regresion betas coicide con el numero de varibales indp y dep
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
SCT
SCREGRE
SCRERROR
CME <-
GLREGRE <- K-1
GLERROR <- n-k
GLREGRE <- K-1;GLREGRE
GLREGRE
GLREGRE <- k-1;GLREGRE
GLERROR <- n-k;GLERROR
GLTOTAL <- n-1;GLTOTAL
CMREGRE <- SCREGRE/GLREGRE
CMERROR <- SCRERROR/GLERROR
CMREGRE <- SCREGRE/GLREGRE;CMREGRE
CMERROR <- SCRERROR/GLERROR;CMERROR
FCALCULADO <- CMREGRE/CMERROR
FCALCULADO <- CMREGRE/CMERROR;FCALCULADO
SCREGRE
SCRERROR
SCT
SCREGRE
SCRERROR
SCT
GLREGRE <- k-1;GLREGRE
GLERROR <- n-k;GLERROR
GLTOTAL <- n-1;GLTOTAL
qf(1-0.05,k-1,n-k)
Fcritico <- qf(1-0.05,k-1,n-k)
Fcritico <- qf(1-0.05,k-1,n-k)
Fcritico <- qf(1-0.05,k-1,n-k);Fcritico
FCALCULADO>Fcritico
betas <- solve(t(X)%*%X)%*%(t(X)%*%y)
betasest <- solve(t(X)%*%X)%*%(t(X)%*%y)
betasest
anva
anova
modelo %>% summary()
library(tidyverse)
datos <- read_csv("seguro.csv")
datos <- datos %>% select(-region) %>%
rename(edad = 1,sexo = 2,imc = 3,nhijos = 4,fuma = 5,gastos = 6)%>%
mutate(sexo = recode(sexo, male = "masculino", female = "femenino"),
fuma = recode(fuma, yes = "si", no = "no"))
datos
#################################################################################################
names(datos)
attach(datos)
X <- model.matrix(gastos~edad+sexo+imc+nhijos+fuma,data=datos)
C <- solve(t(X)%*%X);C
dim(C) #matriz de dimencion k*k ... k:número de coeficientes de c
t
y <- data.matrix(gastos)
dim(y)
dim(t(X))
t(X)%*%y
betasest <- solve(t(X)%*%X)%*%(t(X)%*%y)
library(broom)
modelo <- lm(gastos~ ., data = datos)
modelo |> summary()
library(broom)
modelo |> aov() |> summary()
anva <- modelo |> anova();anva
#I_n : matriz identidad de n*n
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
#J_n : matriz de puro 1s ,dim nxn
(diag(n)-(1/n)*J_n)%*%y
dim((1/n)*J_n)
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
I_n <- diag(n)
SCT <- t(y)%*%(I_n-(1/n)*matrix(c(rep(1,n*n)),nrow = n, ncol = n))%*%y;SCT
SCT<-sum(anva[,2]);SCT
#H_n : matriz hat  identidad de n*n
H <- X%*% solve(t(X)%*%X)%*%(t(X))
dim(H)
SCREGRE <- t(y)%*%(H-(1/n)*J_n)%*%y;SCREGRE
SCRERROR <- t(y)%*%(I_n-H)%*%y;SCRERROR
anva[p+1,2]
#El valor de σ2 es estimado mediante el Cuadrado Medio del Error (sacado del anva)
summary(modelo)$sigma**2
summary(modelo)$sigma**2*solve(t(X)%*%X)
vcov(modelo)
library(car)
names(datos)
modelo |> confidenceEllipse(levels     = 0.96,
fill       = T,
which.coef = c(4,5),
col        = "forestgreen")
modelo <- lm(gastos~ ., data = datos)
modelo %>% summary()
anva <- modelo |> anova();anva
k <- length(names(datos));k #numero de coeficientes de regresion betas coicide con el numero de varibales indp y dep (tener cuidado con el codigo!)
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
GLREGRE <- k-1;GLREGRE
GLERROR <- n-k;GLERROR
GLTOTAL <- n-1;GLTOTAL
SCREGRE
SCRERROR
SCT
CMREGRE <- SCREGRE/GLREGRE;CMREGRE
CMERROR <- SCRERROR/GLERROR;CMERROR
FCALCULADO <- CMREGRE/CMERROR;FCALCULADO
Fcritico <- qf(1-0.05,k-1,n-k);Fcritico
FCALCULADO>Fcritico #SI ES CORRECTO H0 SE RECHAZA
modelo %>% summary()
#I_n : matriz identidad de n*n
I_n
#I_n : matriz identidad de n*n
I_n <- diag(n)
n <- length(gastos);n # cantidad de valores de y
p <- length(names(datos))-1;p# 5variables indp y 1 indep
#I_n : matriz identidad de n*n
I_n <- diag(n)
J_n <- matrix(c(rep(1,n*n)),nrow = n, ncol = n)
#J_n : matriz de puro 1s ,dim nxn
#(diag(n)-(1/n)*J_n)%*%y
#dim((1/n)*J_n)
matrix(c(rep(1,n*n)),nrow = n, ncol = n)
